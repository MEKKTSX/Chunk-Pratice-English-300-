<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>English Sentence Bank</title>
    
    <link rel="manifest" href="manifest.json">
    
    <meta name="theme-color" content="#2563eb">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ESB Thai">
    <link rel="apple-touch-icon" href="icon.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        body { 
            -webkit-tap-highlight-color: transparent; 
            overscroll-behavior-y: none;
            touch-action: pan-y;
        }
        .card-tap-active:active {
            transform: scale(0.98);
        }
        /* Quiz Card Animations */
        .quiz-card {
            transition: transform 0.3s ease-out, opacity 0.3s ease-out;
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
        }
        .slide-left {
            transform: translateX(-120%) rotate(-10deg);
            opacity: 0;
        }
        .slide-right {
            transform: translateX(120%) rotate(10deg);
            opacity: 0;
        }
        .card-stack-effect {
            transform: scale(0.95) translateY(10px);
            opacity: 0.5;
            z-index: -1;
        }
        @keyframes bounce-in-up {
            0% { transform: translate(-50%, 100px); opacity: 0; }
            60% { transform: translate(-50%, -10px); opacity: 1; }
            100% { transform: translate(-50%, 0); }
        }
        .animate-bounce-in {
            animation: bounce-in-up 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans min-h-screen pb-20 select-none overflow-x-hidden">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- ICONS ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );
        const BookOpen = (p) => <IconBase {...p}><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></IconBase>;
        const ToggleLeft = (p) => <IconBase {...p}><rect width="20" height="12" x="2" y="6" rx="6" ry="6"/><circle cx="8" cy="12" r="2"/></IconBase>;
        const ToggleRight = (p) => <IconBase {...p}><rect width="20" height="12" x="2" y="6" rx="6" ry="6"/><circle cx="16" cy="12" r="2"/></IconBase>;
        const ChevronDown = (p) => <IconBase {...p}><path d="m6 9 6 6 6-6"/></IconBase>;
        const ChevronUp = (p) => <IconBase {...p}><path d="m18 15-6-6-6 6"/></IconBase>;
        const ArrowRightLeft = (p) => <IconBase {...p}><path d="m16 3 4 4-4 4"/><path d="M20 7H4"/><path d="m8 21-4-4 4-4"/><path d="M4 17h16"/></IconBase>;
        const Brain = (p) => <IconBase {...p}><path d="M9.5 2A2.5 2.5 0 0 1 12 4.5v15a2.5 2.5 0 0 1-4.96.44 2.5 2.5 0 0 1-2.96-3.08 3 3 0 0 1-.34-5.58 2.5 2.5 0 0 1 1.32-4.24 2.5 2.5 0 0 1 1.98-3A2.5 2.5 0 0 1 9.5 2Z"/><path d="M14.5 2A2.5 2.5 0 0 0 12 4.5v15a2.5 2.5 0 0 0 4.96.44 2.5 2.5 0 0 0 2.96-3.08 3 3 0 0 0 .34-5.58 2.5 2.5 0 0 0-1.32-4.24 2.5 2.5 0 0 0-1.98-3A2.5 2.5 0 0 0 14.5 2Z"/></IconBase>;
        const Circle = (p) => <IconBase {...p}><circle cx="12" cy="12" r="10"/></IconBase>;
        const CheckCircle = (p) => <IconBase {...p}><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></IconBase>;
        const X = (p) => <IconBase {...p}><path d="M18 6 6 18"/><path d="m6 6 18 18"/></IconBase>;
        const RotateCcw = (p) => <IconBase {...p}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 12"/><path d="M3 3v9h9"/></IconBase>;
        const Play = (p) => <IconBase {...p}><polygon points="5 3 19 12 5 21 5 3"/></IconBase>;

        // --- DATA SECTION ---
        const SentenceData = [
          {
            id: 'A',
            title: 'A. Greetings & General Small Talk',
            color: 'bg-blue-100 border-blue-200 text-blue-800',
            sentences: [
              { en: "How are you?", th: "สบายดีไหม?" },
              { en: "How are you doing?", th: "เป็นไงบ้าง?" },
              { en: "How are you today?", th: "วันนี้เป็นไงบ้าง?" },
              { en: "How is it going?", th: "ความเป็นอยู่เป็นไงบ้าง?" },
              { en: "How is everything?", th: "ทุกอย่างเป็นไงบ้าง?" },
              { en: "How's life?", th: "ชีวิตเป็นไงบ้าง?" },
              { en: "What’s up?", th: "ว่าไง / มีไรเปล่า?" },
              { en: "What’s new?", th: "มีอะไรใหม่ๆ บ้างไหม?" },
              { en: "What’s happening?", th: "เกิดอะไรขึ้น / ทำไรอยู่?" },
              { en: "What are you up to?", th: "ทำอะไรอยู่บ้างช่วงนี้?" },
              { en: "What are you doing right now?", th: "ตอนนี้ทำอะไรอยู่?" },
              { en: "It’s good to see you.", th: "ดีใจที่ได้เจอกันนะ" },
              { en: "It’s nice to meet you.", th: "ยินดีที่ได้รู้จัก" },
              { en: "It’s been a long time.", th: "ไม่ได้เจอกันนานเลยนะ" },
              { en: "I’m fine, thanks.", th: "ฉันสบายดี ขอบใจนะ" },
              { en: "I’m doing well.", th: "ฉันสบายดี" },
              { en: "I’m pretty good.", th: "ก็ค่อนข้างดีนะ" },
              { en: "I’m doing okay.", th: "ฉันก็โอเคนะ" },
              { en: "I’m not bad.", th: "ก็ไม่แย่นะ" },
              { en: "I’m a bit tired today.", th: "วันนี้ฉันเหนื่อยนิดหน่อย" },
              { en: "I’m so busy these days.", th: "ช่วงนี้ฉันยุ่งมาก" },
              { en: "Everything is fine.", th: "ทุกอย่างเรียบร้อยดี" },
              { en: "Everything is great.", th: "ทุกอย่างโอเคมาก" },
              { en: "Same as usual.", th: "ก็เหมือนเดิมแหละ" },
              { en: "Can’t complain.", th: "ก็เรื่อยๆ (ไม่มีไรให้บ่น)" },
              { en: "You look great.", th: "คุณดูดีจัง" },
              { en: "You look tired.", th: "คุณดูเหนื่อยๆ นะ" },
              { en: "You look happy today.", th: "วันนี้คุณดูมีความสุขนะ" }
            ]
          },
          {
            id: 'B',
            title: 'B. Daily Routines & Habits',
            color: 'bg-yellow-100 border-yellow-200 text-yellow-800',
            sentences: [
              { en: "I get up early every day.", th: "ฉันตื่นเช้าทุกวัน" },
              { en: "I usually get up at 7 a.m.", th: "ปกติฉันตื่น 7 โมงเช้า" },
              { en: "I always wake up late on weekends.", th: "ฉันตื่นสายตลอดช่วงสุดสัปดาห์" },
              { en: "I make my bed every morning.", th: "ฉันเก็บที่นอนทุกเช้า" },
              { en: "I brush my teeth twice a day.", th: "ฉันแปรงฟันวันละ 2 ครั้ง" },
              { en: "I take a shower in the morning.", th: "ฉันอาบน้ำตอนเช้า" },
              { en: "I get dressed quickly.", th: "ฉันแต่งตัวอย่างรวดเร็ว" },
              { en: "I usually drink coffee.", th: "ปกติฉันดื่มกาแฟ" },
              { en: "I drink coffee every morning.", th: "ฉันดื่มกาแฟทุกเช้า" },
              { en: "I don't drink coffee.", th: "ฉันไม่ดื่มกาแฟ" },
              { en: "I don't usually eat breakfast.", th: "ปกติฉันไม่กินมื้อเช้า" },
              { en: "I have lunch at noon.", th: "ฉันกินมื้อเที่ยงตอนเที่ยงตรง" },
              { en: "I leave the house at 8 a.m.", th: "ฉันออกจากบ้านตอน 8 โมง" },
              { en: "I drive to work.", th: "ฉันขับรถไปทำงาน" },
              { en: "I take the bus to school.", th: "ฉันนั่งรถเมล์ไปโรงเรียน" },
              { en: "I walk to the station.", th: "ฉันเดินไปสถานี" },
              { en: "I come home late.", th: "ฉันกลับบ้านดึก" },
              { en: "I usually cook dinner.", th: "ปกติฉันทำมื้อเย็นกินเอง" },
              { en: "I watch TV in the evening.", th: "ฉันดูทีวีตอนเย็น" },
              { en: "I read a book before bed.", th: "ฉันอ่านหนังสือก่อนนอน" },
              { en: "I go to sleep at midnight.", th: "ฉันเข้านอนตอนเที่ยงคืน" },
              { en: "What time do you get up?", th: "คุณตื่นนอนกี่โมง?" },
              { en: "What time do you leave?", th: "คุณออก(จากบ้าน)กี่โมง?" },
              { en: "What time do you go to bed?", th: "คุณเข้านอนกี่โมง?" },
              { en: "Do you exercise?", th: "คุณออกกำลังกายไหม?" },
              { en: "Do you work out every day?", th: "คุณออกกำลังกายทุกวันไหม?" },
              { en: "Do you cook at home?", th: "คุณทำกับข้าวที่บ้านไหม?" },
              { en: "Do you take the bus?", th: "คุณนั่งรถเมล์หรือเปล่า?" },
              { en: "How do you get to work?", th: "คุณไปทำงานยังไง?" },
              { en: "How often do you clean your room?", th: "คุณทำความสะอาดห้องบ่อยไหม?" }
            ]
          },
          {
            id: 'C',
            title: 'C. Study & Work',
            color: 'bg-orange-100 border-orange-200 text-orange-800',
            sentences: [
              { en: "I work in an office.", th: "ฉันทำงานในออฟฟิศ" },
              { en: "I work for a big company.", th: "ฉันทำงานบริษัทใหญ่" },
              { en: "I work from home today.", th: "วันนี้ฉันทำงานที่บ้าน" },
              { en: "I'm working right now.", th: "ตอนนี้ฉันทำงานอยู่" },
              { en: "I'm busy with work.", th: "ฉันยุ่งเรื่องงานอยู่" },
              { en: "I'm in a meeting.", th: "ฉันติดประชุมอยู่" },
              { en: "I have a meeting at 10.", th: "ฉันมีประชุมตอน 10 โมง" },
              { en: "I have a lot of work to do.", th: "ฉันมีงานต้องทำเยอะมาก" },
              { en: "I study English every day.", th: "ฉันเรียนภาษาอังกฤษทุกวัน" },
              { en: "I'm studying for a test.", th: "ฉันกำลังติวสอบอยู่" },
              { en: "I'm learning Spanish.", th: "ฉันกำลังเรียนภาษาสเปน" },
              { en: "It’s very difficult.", th: "มันยากมาก" },
              { en: "It’s not easy.", th: "มันไม่ง่ายเลย" },
              { en: "It takes a long time.", th: "มันใช้เวลานาน" },
              { en: "My boss is nice.", th: "หัวหน้าฉันนิสัยดี" },
              { en: "My colleagues are friendly.", th: "เพื่อนร่วมงานเป็นกันเอง" },
              { en: "Do you work today?", th: "วันนี้ทำงานไหม?" },
              { en: "Do you like your job?", th: "คุณชอบงานของคุณไหม?" },
              { en: "Do you have a lot of homework?", th: "การบ้านเยอะไหม?" },
              { en: "What do you do?", th: "คุณทำงานอะไร?" },
              { en: "What do you do for a living?", th: "คุณทำอาชีพอะไร?" },
              { en: "Where do you work?", th: "คุณทำงานที่ไหน?" },
              { en: "Which school do you go to?", th: "คุณเรียนโรงเรียนไหน?" },
              { en: "Are you busy?", th: "ยุ่งอยู่ไหม?" },
              { en: "Are you still working?", th: "ยังทำงานอยู่เหรอ?" },
              { en: "When does the meeting start?", th: "ประชุมเริ่มกี่โมง?" },
              { en: "When does the class finish?", th: "เลิกเรียนกี่โมง?" }
            ]
          },
          {
            id: 'D',
            title: 'D. Friends & Social Life',
            color: 'bg-indigo-100 border-indigo-200 text-indigo-800',
            sentences: [
              { en: "Do you want to go out?", th: "อยากออกไปข้างนอกไหม?" },
              { en: "Do you want to join us?", th: "อยากไปด้วยกันไหม?" },
              { en: "Do you want to come over?", th: "อยากแวะมาหาไหม?" },
              { en: "Do you want to grab coffee?", th: "ไปดื่มกาแฟกันไหม?" },
              { en: "Do you have time?", th: "มีเวลาไหม?" },
              { en: "Do you have plans tonight?", th: "คืนนี้มีแผนทำอะไรหรือยัง?" },
              { en: "Are you free this weekend?", th: "สุดสัปดาห์นี้ว่างไหม?" },
              { en: "Are you free later?", th: "เดี๋ยวว่างไหม (หลังจากนี้)?" },
              { en: "Are you ready to go?", th: "พร้อมไปหรือยัง?" },
              { en: "Can you make it?", th: "คุณมาได้ไหม / สะดวกไหม?" },
              { en: "Let’s go.", th: "ไปกันเถอะ" },
              { en: "Let’s meet up.", th: "มาเจอกันหน่อยไหม" },
              { en: "Let’s hang out.", th: "ไปเที่ยวเล่น/สังสรรค์กันเถอะ" },
              { en: "Let’s grab a drink.", th: "ไปหาอะไรดื่มกันเถอะ" },
              { en: "Let’s do something fun.", th: "หาอะไรสนุกๆ ทำกันเถอะ" },
              { en: "I’m free today.", th: "วันนี้ฉันว่าง" },
              { en: "I’m busy tonight.", th: "คืนนี้ฉันไม่ว่าง" },
              { en: "I’m hanging out with friends.", th: "ฉันกำลังสังสรรค์กับเพื่อน" },
              { en: "I’m waiting for a friend.", th: "ฉันกำลังรอเพื่อนอยู่" },
              { en: "We are having a party.", th: "พวกเรากำลังมีปาร์ตี้กัน" },
              { en: "Where are you?", th: "คุณอยู่ที่ไหน?" },
              { en: "Where are we going?", th: "เรากำลังจะไปไหนกัน?" },
              { en: "Who are you with?", th: "คุณอยู่กับใคร?" },
              { en: "Who is coming?", th: "ใครจะมาบ้าง?" },
              { en: "How about dinner?", th: "ไปกินมื้อเย็นกันไหม?" },
              { en: "How about a movie?", th: "ดูหนังกันไหม?" }
            ]
          },
          {
            id: 'E',
            title: 'E. Feelings, Opinions & Preferences',
            color: 'bg-purple-100 border-purple-200 text-purple-800',
            sentences: [
              { en: "I like it.", th: "ฉันชอบนะ" },
              { en: "I really like it.", th: "ฉันชอบมันมาก" },
              { en: "I love this song.", th: "ฉันรักเพลงนี้" },
              { en: "I enjoy reading.", th: "ฉันสนุกกับการอ่าน" },
              { en: "I prefer tea.", th: "ฉันชอบชามากกว่า" },
              { en: "I don't like it.", th: "ฉันไม่ชอบเลย" },
              { en: "I hate waiting.", th: "ฉันเกลียดการรอคอย" },
              { en: "I don't care.", th: "ฉันไม่แคร์ / ไม่สน" },
              { en: "I don't mind.", th: "ฉันไม่ถือสา / ไม่ติดขัดอะไร" },
              { en: "It doesn't matter.", th: "ไม่สำคัญหรอก / ช่างเถอะ" },
              { en: "I feel happy.", th: "ฉันมีความสุข" },
              { en: "I feel sad.", th: "ฉันเศร้า" },
              { en: "I feel tired.", th: "ฉันรู้สึกเหนื่อย" },
              { en: "I feel sick.", th: "ฉันรู้สึกป่วย" },
              { en: "I feel better now.", th: "ฉันรู้สึกดีขึ้นแล้ว" },
              { en: "I think so.", th: "ฉันก็คิดงั้นนะ" },
              { en: "I don't think so.", th: "ฉันไม่คิดงั้นนะ" },
              { en: "I think it’s good.", th: "ฉันว่ามันก็ดีนะ" },
              { en: "I think it’s too expensive.", th: "ฉันว่ามันแพงไป" },
              { en: "I believe you.", th: "ฉันเชื่อคุณ" },
              { en: "I agree with you.", th: "ฉันเห็นด้วยกับคุณ" },
              { en: "I totally agree.", th: "ฉันเห็นด้วยสุดๆ" },
              { en: "I disagree.", th: "ฉันไม่เห็นด้วย" },
              { en: "Do you like it?", th: "คุณชอบไหม?" },
              { en: "Do you think it’s okay?", th: "คุณคิดว่ามันโอเคไหม?" },
              { en: "What do you think?", th: "คุณคิดว่าไง?" },
              { en: "What do you prefer?", th: "คุณชอบอันไหนมากกว่า?" },
              { en: "How do you feel?", th: "คุณรู้สึกยังไง?" }
            ]
          },
          {
            id: 'F',
            title: 'F. Asking for & Giving Information',
            color: 'bg-red-100 border-red-200 text-red-800',
            sentences: [
              { en: "Excuse me.", th: "ขอโทษนะครับ/คะ" },
              { en: "Do you speak English?", th: "คุณพูดภาษาอังกฤษได้ไหม?" },
              { en: "Do you understand?", th: "คุณเข้าใจไหม?" },
              { en: "Do you know him?", th: "คุณรู้จักเขาไหม?" },
              { en: "Do you know where it is?", th: "รู้ไหมว่ามันอยู่ที่ไหน?" },
              { en: "Do you know what time it is?", th: "รู้ไหมว่ากี่โมงแล้ว?" },
              { en: "Does this bus go to the city?", th: "รถเมล์คันนี้เข้าเมืองไหม?" },
              { en: "Is this seat free?", th: "ที่ตรงนี้ว่างไหม?" },
              { en: "Is it open?", th: "มันเปิดอยู่ไหม?" },
              { en: "Is it far from here?", th: "ไกลจากที่นี่ไหม?" },
              { en: "Where is the bathroom?", th: "ห้องน้ำอยู่ที่ไหน?" },
              { en: "Where is the nearest station?", th: "สถานีที่ใกล้ที่สุดอยู่ที่ไหน?" },
              { en: "Where is the exit?", th: "ทางออกอยู่ที่ไหน?" },
              { en: "What is this?", th: "นี่คืออะไร?" },
              { en: "What does this mean?", th: "นี่หมายความว่าอะไร?" },
              { en: "What is the password?", th: "รหัสผ่านคืออะไร?" },
              { en: "How much is it?", th: "ราคาเท่าไหร่?" },
              { en: "How much does it cost?", th: "มันราคาเท่าไหร่?" },
              { en: "How long does it take?", th: "ใช้เวลานานแค่ไหน?" },
              { en: "The bank is closed.", th: "ธนาคารปิดแล้ว" },
              { en: "The store is open.", th: "ร้านเปิดอยู่" },
              { en: "It is on the right.", th: "มันอยู่ทางขวา" },
              { en: "It is on the left.", th: "มันอยู่ทางซ้าย" },
              { en: "It is next to the hotel.", th: "มันอยู่ติดกับโรงแรม" }
            ]
          },
          {
            id: 'G',
            title: 'G. Offers, Requests & Permission',
            color: 'bg-green-100 border-green-200 text-green-800',
            sentences: [
              { en: "Can I help you?", th: "ให้ฉันช่วยไหม?" },
              { en: "Can I ask a question?", th: "ขอถามอะไรหน่อยได้ไหม?" },
              { en: "Can I use your phone?", th: "ขอยืมโทรศัพท์หน่อยได้ไหม?" },
              { en: "Can I sit here?", th: "ขอนั่งตรงนี้ได้ไหม?" },
              { en: "Can I get a glass of water?", th: "ขอน้ำสักแก้วได้ไหม?" },
              { en: "Can I have the bill, please?", th: "เช็คบิลด้วยครับ/ค่ะ" },
              { en: "Can you help me?", th: "ช่วยฉันหน่อยได้ไหม?" },
              { en: "Can you repeat that?", th: "ช่วยพูดอีกทีได้ไหม?" },
              { en: "Can you speak slower?", th: "พูดช้าลงหน่อยได้ไหม?" },
              { en: "Can you open the window?", th: "ช่วยเปิดหน้าต่างหน่อยได้ไหม?" },
              { en: "Can you explain this?", th: "ช่วยอธิบายอันนี้หน่อยได้ไหม?" },
              { en: "Could you do me a favor?", th: "ช่วยอะไรฉันสักอย่างได้ไหม?" },
              { en: "Do you need anything?", th: "ต้องการอะไรไหม?" },
              { en: "Do you need help?", th: "ต้องการความช่วยเหลือไหม?" },
              { en: "Do you want some water?", th: "เอาน้ำหน่อยไหม?" },
              { en: "Would you like to come?", th: "อยากมาด้วยกันไหม?" },
              { en: "I can do it.", th: "ฉันทำได้" },
              { en: "I can’t do it.", th: "ฉันทำไม่ได้" },
              { en: "I can’t find my keys.", th: "ฉันหากุญแจไม่เจอ" },
              { en: "I can’t hear you.", th: "ฉันไม่ได้ยินคุณ" },
              { en: "You can park here.", th: "คุณจอดรถตรงนี้ได้" },
              { en: "You can’t smoke here.", th: "ห้ามสูบบุหรี่ตรงนี้" }
            ]
          },
          {
            id: 'H',
            title: 'H. Plans & Arrangements',
            color: 'bg-teal-100 border-teal-200 text-teal-800',
            sentences: [
              { en: "What are you doing tomorrow?", th: "พรุ่งนี้คุณจะทำอะไร?" },
              { en: "What are you doing this weekend?", th: "สุดสัปดาห์นี้ทำอะไร?" },
              { en: "Are you doing anything special?", th: "มีทำอะไรพิเศษไหม?" },
              { en: "I’m staying home today.", th: "วันนี้ฉันจะอยู่บ้าน" },
              { en: "I’m going shopping.", th: "ฉันจะไปช้อปปิ้ง" },
              { en: "I’m meeting a friend.", th: "ฉันนัดเพื่อนไว้" },
              { en: "I’m visiting my parents.", th: "ฉันจะไปหาพ่อแม่" },
              { en: "I’m traveling to Japan.", th: "ฉันกำลังจะไปเที่ยวญี่ปุ่น" },
              { en: "I’m going to clean my room.", th: "ฉันกะว่าจะทำความสะอาดห้อง" },
              { en: "I’m going to cook dinner.", th: "ฉันกะว่าจะทำมื้อเย็น" },
              { en: "I’m going to be late.", th: "ฉันน่าจะไปสาย" },
              { en: "I’m going to buy a new phone.", th: "ฉันจะซื้อโทรศัพท์ใหม่" },
              { en: "We are leaving soon.", th: "พวกเราจะไปเร็วๆ นี้แหละ" },
              { en: "We are moving house next week.", th: "เราจะย้ายบ้านอาทิตย์หน้า" },
              { en: "We are planning a trip.", th: "เรากำลังวางแผนเที่ยวกัน" },
              { en: "I plan to study abroad.", th: "ฉันวางแผนจะไปเรียนต่อนอก" },
              { en: "I want to go there.", th: "ฉันอยากไปที่นั่น" },
              { en: "I need to go now.", th: "ฉันต้องไปแล้ว" },
              { en: "I have to go.", th: "ฉันจำเป็นต้องไป" },
              { en: "I don't want to go.", th: "ฉันไม่อยากไป" }
            ]
          },
          {
            id: 'I',
            title: 'I. Online, Phone & Chat',
            color: 'bg-cyan-100 border-cyan-200 text-cyan-800',
            sentences: [
              { en: "Can you hear me?", th: "ได้ยินฉันไหม?" },
              { en: "Can you see me?", th: "เห็นฉันไหม?" },
              { en: "Can you see my screen?", th: "เห็นหน้าจอฉันไหม?" },
              { en: "The connection is bad.", th: "สัญญาณไม่ดีเลย" },
              { en: "The internet is slow.", th: "เน็ตช้ามาก" },
              { en: "You are breaking up.", th: "เสียงคุณขาดๆ หายๆ" },
              { en: "You are on mute.", th: "คุณปิดไมค์อยู่" },
              { en: "I’m calling you now.", th: "ฉันกำลังโทรหาคุณ" },
              { en: "I’m texting you.", th: "ฉันกำลังส่งข้อความหาคุณ" },
              { en: "I’m sending an email.", th: "ฉันกำลังส่งอีเมล" },
              { en: "I’m waiting for your reply.", th: "ฉันรอคุณตอบอยู่นะ" },
              { en: "Let me check my phone.", th: "ขอเช็คโทรศัพท์แป๊บ" },
              { en: "Let me Google it.", th: "เดี๋ยวขอลองกูเกิลดูก่อน" },
              { en: "Check your inbox.", th: "เช็คกล่องข้อความหน่อย" },
              { en: "Send me the link.", th: "ส่งลิงก์มาให้หน่อย" },
              { en: "Text me later.", th: "ส่งข้อความมาทีหลังนะ" },
              { en: "Call me back.", th: "โทรกลับด้วยนะ" },
              { en: "My battery is low.", th: "แบตเตอรี่ฉันต่ำแล้ว" },
              { en: "My phone is dead.", th: "มือถือฉันแบตหมด" }
            ]
          },
          {
            id: 'J',
            title: 'J. Problems & Complaints',
            color: 'bg-rose-100 border-rose-200 text-rose-800',
            sentences: [
              { en: "I have a problem.", th: "ฉันมีปัญหา" },
              { en: "I have a headache.", th: "ฉันปวดหัว" },
              { en: "I have a cold.", th: "ฉันเป็นหวัด" },
              { en: "I’m lost.", th: "ฉันหลงทาง" },
              { en: "I’m confused.", th: "ฉันงง / สับสน" },
              { en: "I’m so stressed.", th: "ฉันเครียดมาก" },
              { en: "It doesn't work.", th: "มันใช้งานไม่ได้" },
              { en: "It’s broken.", th: "มันพัง / แตก" },
              { en: "It’s too loud.", th: "เสียงดังเกินไป" },
              { en: "It’s too cold in here.", th: "ในนี้หนาวเกินไป" },
              { en: "It’s too expensive.", th: "มันแพงเกินไป" },
              { en: "It’s really annoying.", th: "มันน่ารำคาญจริงๆ" },
              { en: "There is a mistake.", th: "มีความผิดพลาดเกิดขึ้น" },
              { en: "There is no internet.", th: "เน็ตใช้ไม่ได้ / ไม่มีเน็ต" },
              { en: "The traffic is terrible.", th: "การจราจรแย่มาก (รถติด)" },
              { en: "This is not what I ordered.", th: "นี่ไม่ใช่ที่ฉันสั่งไป" },
              { en: "This is taking too long.", th: "นี่มันใช้เวลานานเกินไปแล้ว" },
              { en: "Something is wrong.", th: "มีบางอย่างผิดปกติ" },
              { en: "I don't have enough money.", th: "ฉันมีเงินไม่พอ" },
              { en: "I don't have time.", th: "ฉันไม่มีเวลา" },
              { en: "I can't find my wallet.", th: "ฉันหากระเป๋าตังค์ไม่เจอ" },
              { en: "I'm running late.", th: "ฉันกำลังจะไปสายแล้ว" }
            ]
          },
          {
            id: 'K',
            title: 'K. Reactions & Exclamations',
            color: 'bg-amber-100 border-amber-200 text-amber-800',
            sentences: [
              { en: "That’s great!", th: "ยอดเยี่ยมไปเลย!" },
              { en: "That’s good news.", th: "ข่าวดีเลยนะนั่น" },
              { en: "That’s awesome.", th: "เจ๋งไปเลย" },
              { en: "That’s interesting.", th: "น่าสนใจแฮะ" },
              { en: "That’s nice.", th: "ดีจังเลย" },
              { en: "That’s funny.", th: "ตลกจัง" },
              { en: "That’s weird.", th: "แปลกจัง" },
              { en: "That’s too bad.", th: "แย่จังเลย" },
              { en: "That’s terrible.", th: "เลวร้ายมาก" },
              { en: "That’s crazy.", th: "บ้าไปแล้ว" },
              { en: "That’s impossible.", th: "เป็นไปไม่ได้น่า" },
              { en: "That’s right.", th: "ถูกต้องเลย" },
              { en: "That’s wrong.", th: "ผิดแล้วล่ะ" },
              { en: "That’s enough.", th: "พอได้แล้ว" },
              { en: "No way!", th: "ไม่มีทาง! / ไม่จริงน่า!" },
              { en: "Oh my god.", th: "คุณพระช่วย / พระเจ้าช่วย" },
              { en: "Are you serious?", th: "พูดจริงดิ? / เอาจริงเหรอ?" },
              { en: "Are you kidding me?", th: "ล้อเล่นป่ะเนี่ย?" },
              { en: "Really?", th: "จริงเหรอ?" },
              { en: "Exactly!", th: "เป๊ะเลย / ใช่เลย!" },
              { en: "Absolutely!", th: "แน่นอนที่สุด / ชัวร์ป้าบ" },
              { en: "Definitely.", th: "แน่นอน" },
              { en: "Sounds good.", th: "ฟังดูดีนะ" },
              { en: "Sounds like a plan.", th: "เอาตามแผนนี้เลย (ตกลง)" },
              { en: "Good luck!", th: "โชคดีนะ!" },
              { en: "Take care.", th: "ดูแลตัวเองนะ" },
              { en: "Don't worry.", th: "ไม่ต้องกังวลนะ" },
              { en: "Never mind.", th: "ช่างมันเถอะ / ไม่เป็นไร" }
            ]
          },
          {
            id: 'L',
            title: 'L. University Life, Technology & AI',
            color: 'bg-sky-100 border-sky-200 text-sky-800',
            sentences: [
              { en: "I’m a student.", th: "ฉันเป็นนักเรียน/นักศึกษา" },
              { en: "I go to university.", th: "ฉันเรียนมหาวิทยาลัย" },
              { en: "I have a class now.", th: "ตอนนี้มีเรียน" },
              { en: "I have an exam tomorrow.", th: "พรุ่งนี้ฉันมีสอบ" },
              { en: "The lecture is boring.", th: "บรรยาย/เลคเชอร์น่าเบื่อมาก" },
              { en: "The professor is strict.", th: "อาจารย์ดุ/เข้มงวดมาก" },
              { en: "Where is the library?", th: "ห้องสมุดอยู่ที่ไหน?" },
              { en: "Is the library open?", th: "ห้องสมุดเปิดอยู่ไหม?" },
              { en: "I need to print this.", th: "ฉันต้องปรินต์อันนี้" },
              { en: "I use my laptop every day.", th: "ฉันใช้แล็ปท็อปทุกวัน" },
              { en: "I use social media a lot.", th: "ฉันเล่นโซเชียลบ่อยมาก" },
              { en: "I don't use Facebook.", th: "ฉันไม่เล่นเฟซบุ๊ก" },
              { en: "Do you use Instagram?", th: "คุณเล่นไอจีไหม?" },
              { en: "Do you use ChatGPT?", th: "คุณใช้ ChatGPT ไหม?" },
              { en: "I use AI for my homework.", th: "ฉันใช้ AI ช่วยทำการบ้าน" },
              { en: "It helps me write emails.", th: "มันช่วยฉันเขียนอีเมล" },
              { en: "It translates text quickly.", th: "มันแปลข้อความได้เร็วมาก" },
              { en: "The app keeps crashing.", th: "แอปมันเด้งหลุดตลอดเลย" },
              { en: "I need to update my phone.", th: "ฉันต้องอัปเดตมือถือ" },
              { en: "I need to charge my laptop.", th: "ฉันต้องชาร์จแบตแล็ปท็อป" },
              { en: "Do you have a charger?", th: "มีที่ชาร์จไหม?" },
              { en: "Is there Wi-Fi here?", th: "ที่นี่มีไวไฟไหม?" },
              { en: "What is the Wi-Fi password?", th: "รหัสไวไฟคืออะไร?" },
              { en: "I’m playing video games.", th: "ฉันกำลังเล่นเกม" },
              { en: "I’m watching a stream.", th: "ฉันกำลังดูไลฟ์สตรีม" },
              { en: "I’m scrolling through TikTok.", th: "ฉันกำลังไถ TikTok อยู่" }
            ]
          },
          {
            id: 'M',
            title: 'M. Bonus Series: "I am" & "It is"',
            color: 'bg-fuchsia-100 border-fuchsia-200 text-fuchsia-800',
            sentences: [
              { en: "I’m hungry.", th: "ฉันหิว" },
              { en: "I’m thirsty.", th: "ฉันกระหายน้ำ/หิวน้ำ" },
              { en: "I’m full.", th: "ฉันอิ่มแล้ว" },
              { en: "I’m nervous.", th: "ฉันประหม่า / ตื่นเต้น(กลัว)" },
              { en: "I’m excited.", th: "ฉันตื่นเต้น (ดีใจ)" },
              { en: "I’m bored.", th: "ฉันเบื่อ" },
              { en: "I’m ready.", th: "ฉันพร้อมแล้ว" },
              { en: "I’m sure.", th: "ฉันมั่นใจ" },
              { en: "I’m not sure.", th: "ฉันไม่แน่ใจ" },
              { en: "It’s sunny today.", th: "วันนี้แดดจ้า" },
              { en: "It’s raining right now.", th: "ตอนนี้ฝนตกอยู่" },
              { en: "It’s windy outside.", th: "ข้างนอกลมแรง" },
              { en: "It’s getting dark.", th: "เริ่มมืดแล้ว" },
              { en: "It’s getting late.", th: "เริ่มดึกแล้ว / สายแล้ว" },
              { en: "It’s almost time.", th: "เกือบถึงเวลาแล้ว" }
            ]
          }
        ];

        // --- COMPONENTS ---

        // Helper: Fisher-Yates shuffle
        function shuffleArray(array) {
          const arr = [...array];
          for (let i = arr.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [arr[i], arr[j]] = [arr[j], arr[i]];
          }
          return arr;
        }

        const SentenceCard = ({ sentence, globalShow, primaryLang, index, resetCount, selectionMode, isSelected, onToggleSelect }) => {
          const [localShow, setLocalShow] = useState(false);
          const show = globalShow || localShow;
          
          useEffect(() => { setLocalShow(false); }, [resetCount]);

          const isEnPrimary = primaryLang === 'en';
          const mainText = isEnPrimary ? sentence.en : sentence.th;
          const hiddenText = isEnPrimary ? sentence.th : sentence.en;
          const hintText = isEnPrimary ? "Tap to translate" : "แตะเพื่อดูภาษาอังกฤษ";

          const handleClick = () => {
             if (selectionMode) {
                 onToggleSelect();
             } else {
                 setLocalShow(!localShow);
             }
          };

          return (
            <div 
              className={`relative p-4 rounded-xl border transition-all duration-200 cursor-pointer card-tap-active ${show && !selectionMode ? 'bg-white border-blue-200 shadow-sm' : 'bg-gray-50 border-gray-100 hover:bg-gray-100'}`}
              onClick={handleClick}
            >
              {selectionMode && (
                  <div className="absolute top-4 right-4 text-blue-600">
                      {isSelected ? <CheckCircle size={24} className="fill-blue-100" /> : <Circle size={24} className="text-gray-300" />}
                  </div>
              )}

              <div className="flex items-start pr-8">
                  <span className="text-xs font-bold opacity-50 mr-2 mt-1.5 min-w-[20px]">{index + 1}.</span>
                  <div className={`font-semibold text-gray-800 text-lg mb-2 leading-tight flex-1 ${selectionMode ? 'select-none' : ''}`}>{mainText}</div>
              </div>
              
              <div className={`text-base text-blue-600 transition-opacity duration-300 font-medium leading-tight pl-7 ${show && !selectionMode ? 'opacity-100' : 'opacity-0 h-0 overflow-hidden'}`}>
                {hiddenText}
              </div>
              
              {!show && !selectionMode && <div className="text-xs text-gray-400 mt-2 font-light italic flex items-center gap-1 pl-7"><span className="w-1 h-1 bg-gray-400 rounded-full inline-block"></span> {hintText}</div>}
            </div>
          );
        };

        const CategorySection = ({ category, globalShow, primaryLang, resetCount, startOffset, selectionMode, selectedIds, onToggleItem, onSelectAll }) => {
          const [isOpen, setIsOpen] = useState(true);
          
          // Calculate if all items in this category are selected
          const categorySentenceIds = category.sentences.map((_, idx) => startOffset + idx);
          const isAllSelected = categorySentenceIds.every(id => selectedIds.has(id));

          return (
            <div className="mb-8">
              <div 
                className={`sticky top-[72px] z-10 flex items-center justify-between p-4 rounded-lg shadow-sm mb-4 cursor-pointer select-none backdrop-blur-sm bg-opacity-95 ${category.color}`}
                onClick={() => setIsOpen(!isOpen)}
              >
                <div className="flex items-center gap-2">
                    <h2 className="text-xl font-bold flex items-center">
                    <span className="mr-2 opacity-70 text-sm">#{category.id}</span>
                    {category.title}
                    </h2>
                </div>
                
                <div className="flex items-center gap-3">
                    {selectionMode && isOpen && (
                        <button 
                            onClick={(e) => { e.stopPropagation(); onSelectAll(categorySentenceIds, !isAllSelected); }}
                            className="text-xs font-bold bg-white/50 hover:bg-white/80 px-2 py-1 rounded text-current border border-current/20"
                        >
                            {isAllSelected ? 'Unselect All' : 'Select All'}
                        </button>
                    )}
                    {isOpen ? <ChevronUp size={20} /> : <ChevronDown size={20} />}
                </div>
              </div>
              
              {isOpen && (
                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3 px-1">
                  {category.sentences.map((s, idx) => {
                    const globalId = startOffset + idx;
                    return (
                        <SentenceCard 
                            key={idx} 
                            index={globalId} 
                            sentence={s} 
                            globalShow={globalShow} 
                            primaryLang={primaryLang}
                            resetCount={resetCount}
                            selectionMode={selectionMode}
                            isSelected={selectedIds.has(globalId)}
                            onToggleSelect={() => onToggleItem(globalId)}
                        />
                    );
                  })}
                </div>
              )}
            </div>
          );
        };

        // --- QUIZ VIEW COMPONENT ---
        const QuizView = ({ quizQueue, onClose, quizLang }) => {
            const [currentIndex, setCurrentIndex] = useState(0);
            const [showAnswer, setShowAnswer] = useState(false);
            const [dragX, setDragX] = useState(0);
            const [isDragging, setIsDragging] = useState(false);
            const startXRef = useRef(0);
            const cardRef = useRef(null);

            const currentCard = quizQueue[currentIndex];
            const nextCard = quizQueue[currentIndex + 1] || null;

            // Language Logic
            const isEnPrimary = quizLang === 'en';
            const question = isEnPrimary ? currentCard.sentence.en : currentCard.sentence.th;
            const answer = isEnPrimary ? currentCard.sentence.th : currentCard.sentence.en;

            const handleNext = () => {
                if (currentIndex < quizQueue.length - 1) {
                    setCurrentIndex(prev => prev + 1);
                    setShowAnswer(false);
                    setDragX(0);
                }
            };

            const handlePrev = () => {
                if (currentIndex > 0) {
                    setCurrentIndex(prev => prev - 1);
                    setShowAnswer(false);
                    setDragX(0);
                }
            };

            // Touch/Mouse Handlers for Swipe
            const onStart = (e) => {
                setIsDragging(true);
                startXRef.current = e.touches ? e.touches[0].clientX : e.clientX;
            };

            const onMove = (e) => {
                if (!isDragging) return;
                const clientX = e.touches ? e.touches[0].clientX : e.clientX;
                const delta = clientX - startXRef.current;
                setDragX(delta);
            };

            const onEnd = () => {
                setIsDragging(false);
                if (dragX < -100) { // Swipe Left -> Next
                    if (currentIndex < quizQueue.length - 1) {
                         handleNext();
                    } else {
                        setDragX(0); // Bounce back if end
                    }
                } else if (dragX > 100) { // Swipe Right -> Prev
                    if (currentIndex > 0) {
                        handlePrev();
                    } else {
                        setDragX(0); // Bounce back if start
                    }
                } else {
                    setDragX(0); // Reset position
                }
            };

            const cardStyle = isDragging ? {
                transform: `translateX(${dragX}px) rotate(${dragX * 0.05}deg)`,
                opacity: 1,
                cursor: 'grabbing'
            } : {
                transform: `translateX(0) rotate(0)`, 
                cursor: 'grab'
            };
            
            let bgHint = "";
            if (isDragging) {
                if (dragX < -50) bgHint = "bg-red-50"; 
                if (dragX > 50) bgHint = "bg-green-50"; 
            }

            return (
                <div className="fixed inset-0 z-50 bg-gray-100 flex flex-col h-full w-full overflow-hidden">
                    {/* Header */}
                    <div className="bg-white px-4 py-3 shadow-sm flex items-center justify-between z-10">
                        <div className="flex items-center gap-2 text-blue-700 font-bold">
                            <Brain size={24} />
                            <span>Random Quiz</span>
                            <span className="text-xs bg-gray-100 px-2 py-0.5 rounded text-gray-500 border border-gray-200 ml-2 font-bold uppercase">
                                {quizLang}
                            </span>
                        </div>
                        <div className="text-sm font-medium text-gray-500">
                            {currentIndex + 1} / {quizQueue.length}
                        </div>
                        <button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-full">
                            <X size={24} />
                        </button>
                    </div>

                    {/* Card Area */}
                    <div className={`flex-1 flex items-center justify-center p-6 relative ${bgHint} transition-colors duration-300`}>
                        
                        {/* Next Card Background (Preview) */}
                        {nextCard && (
                            <div className="absolute w-[85%] md:w-[60%] lg:w-[40%] h-[60%] bg-white rounded-2xl shadow-sm border border-gray-200 card-stack-effect flex items-center justify-center">
                                <span className="text-gray-300 font-bold text-4xl">...</span>
                            </div>
                        )}

                        {/* Active Card */}
                        <div 
                            ref={cardRef}
                            className="quiz-card bg-white w-[90%] md:w-[65%] lg:w-[45%] h-[65%] rounded-2xl shadow-xl border border-gray-100 flex flex-col items-center justify-center p-8 text-center select-none"
                            style={cardStyle}
                            onTouchStart={onStart} onTouchMove={onMove} onTouchEnd={onEnd}
                            onMouseDown={onStart} onMouseMove={onMove} onMouseUp={onEnd} onMouseLeave={onEnd}
                            onClick={() => { if(!isDragging) setShowAnswer(!showAnswer); }}
                        >
                             <div className="mb-6">
                                <span className="inline-block px-3 py-1 bg-blue-50 text-blue-600 rounded-full text-xs font-bold mb-4">
                                    #{currentCard.originalIndex + 1}
                                </span>
                                <h3 className="text-2xl md:text-3xl font-bold text-gray-800 leading-tight">
                                    {question}
                                </h3>
                             </div>

                             <div className={`transition-all duration-300 ${showAnswer ? 'opacity-100 transform translate-y-0' : 'opacity-0 transform translate-y-4'}`}>
                                 <div className="w-12 h-1 bg-gray-100 rounded-full mx-auto mb-4"></div>
                                 <p className="text-xl md:text-2xl text-blue-600 font-medium">
                                     {answer}
                                 </p>
                             </div>

                             <div className="absolute bottom-6 text-gray-300 text-sm animate-pulse">
                                 {showAnswer ? "Swipe Left/Right" : "Tap to Flip"}
                             </div>
                        </div>
                    </div>

                    {/* Controls */}
                    <div className="bg-white p-6 pb-10 border-t flex items-center justify-center gap-8 z-10">
                        <button 
                            onClick={handlePrev} 
                            disabled={currentIndex === 0}
                            className="p-4 rounded-full bg-gray-100 text-gray-600 disabled:opacity-30 active:scale-95 transition-transform"
                        >
                            <RotateCcw size={24} />
                        </button>
                        
                         <div className="text-xs text-gray-400 font-medium uppercase tracking-wider">
                            Swipe or Click
                         </div>

                        <button 
                            onClick={handleNext} 
                            disabled={currentIndex === quizQueue.length - 1}
                            className="p-4 rounded-full bg-blue-600 text-white shadow-lg shadow-blue-200 disabled:opacity-50 active:scale-95 transition-transform"
                        >
                            <Play size={24} className="ml-1" />
                        </button>
                    </div>
                </div>
            );
        };

        const App = () => {
          const [globalShow, setGlobalShow] = useState(false);
          const [primaryLang, setPrimaryLang] = useState('en'); 
          const [resetCount, setResetCount] = useState(0); 
          const [isInstallable, setIsInstallable] = useState(false);
          const [deferredPrompt, setDeferredPrompt] = useState(null);

          // Quiz State
          const [selectionMode, setSelectionMode] = useState(false);
          const [selectedIds, setSelectedIds] = useState(new Set());
          const [quizQueue, setQuizQueue] = useState(null); 
          const [quizLang, setQuizLang] = useState('en'); // Default quiz language
          
          let sentenceCounter = 0;
          const allSentencesFlat = []; 
          SentenceData.forEach(cat => {
              cat.sentences.forEach(s => {
                  allSentencesFlat.push({ ...s, originalIndex: allSentencesFlat.length });
              });
          });

          useEffect(() => {
            window.addEventListener('beforeinstallprompt', (e) => {
              e.preventDefault();
              setDeferredPrompt(e);
              setIsInstallable(true);
            });
          }, []);

          const handleInstall = async () => {
            if (deferredPrompt) {
              deferredPrompt.prompt();
              const { outcome } = await deferredPrompt.userChoice;
              if (outcome === 'accepted') setIsInstallable(false);
              setDeferredPrompt(null);
            }
          };
          
          const toggleLang = () => {
              setPrimaryLang(prev => prev === 'en' ? 'th' : 'en');
              setGlobalShow(false);
              setResetCount(prev => prev + 1);
          };

          const handleGlobalToggle = () => {
              const newShowState = !globalShow;
              setGlobalShow(newShowState);
              if (!newShowState) setResetCount(prev => prev + 1);
          };

          const toggleSelectionMode = () => {
              setSelectionMode(!selectionMode);
              setGlobalShow(false);
              setResetCount(prev => prev + 1);
          };

          const toggleItemSelection = (globalId) => {
              const newSet = new Set(selectedIds);
              if (newSet.has(globalId)) newSet.delete(globalId);
              else newSet.add(globalId);
              setSelectedIds(newSet);
          };

          const handleSelectAllCategory = (ids, shouldSelect) => {
              const newSet = new Set(selectedIds);
              ids.forEach(id => {
                  if (shouldSelect) newSet.add(id);
                  else newSet.delete(id);
              });
              setSelectedIds(newSet);
          };

          const startQuiz = () => {
              if (selectedIds.size === 0) return;
              const selectedSentences = Array.from(selectedIds).map(id => ({
                  sentence: allSentencesFlat[id],
                  originalIndex: id
              }));
              const shuffled = shuffleArray(selectedSentences);
              setQuizQueue(shuffled);
          };

          return (
            <div className="min-h-screen bg-white text-gray-800 font-sans">
              
              {/* Quiz View Overlay */}
              {quizQueue && (
                  <QuizView 
                    quizQueue={quizQueue} 
                    onClose={() => setQuizQueue(null)} 
                    quizLang={quizLang}
                  />
              )}

              {/* Top Bar */}
              <div className="sticky top-0 z-20 bg-white/95 backdrop-blur-md border-b border-gray-200 shadow-sm px-4 py-3 flex items-center justify-between">
                <div className="flex items-center gap-2" onClick={() => window.scrollTo({top: 0, behavior: 'smooth'})}>
                  <BookOpen className="text-blue-600" size={24} />
                  <h1 className="text-xl font-bold tracking-tight text-gray-900 hidden md:block">English Sentence Bank</h1>
                  <h1 className="text-xl font-bold tracking-tight text-gray-900 md:hidden">ESB Thai</h1>
                </div>

                <div className="flex gap-2 items-center">
                   {isInstallable && (
                    <button onClick={handleInstall} className="hidden sm:block px-3 py-2 text-sm bg-blue-600 text-white rounded-full font-medium shadow-sm">Install</button>
                  )}
                  
                  {/* Quiz Mode Toggle */}
                  <button 
                    onClick={toggleSelectionMode}
                    className={`p-2 rounded-full transition-all border ${selectionMode ? 'bg-indigo-100 text-indigo-700 border-indigo-200' : 'bg-gray-50 text-gray-400 border-transparent'}`}
                    title="Quiz Selection Mode"
                  >
                    <Brain size={20} />
                  </button>

                  <button 
                    onClick={toggleLang}
                    className="flex items-center gap-1.5 px-3 py-2 rounded-full font-medium transition-all text-sm bg-gray-100 text-gray-600 hover:bg-gray-200 active:scale-95 border border-gray-200"
                  >
                    <ArrowRightLeft size={16} />
                    <span className="font-bold">{primaryLang === 'en' ? 'EN' : 'TH'}</span>
                  </button>

                  <button 
                    onClick={handleGlobalToggle}
                    disabled={selectionMode}
                    className={`flex items-center gap-2 px-4 py-2 rounded-full font-medium transition-all text-sm md:text-base ${globalShow ? 'bg-blue-600 text-white shadow-md' : 'bg-gray-100 text-gray-600 hover:bg-gray-200'} ${selectionMode ? 'opacity-30 cursor-not-allowed' : ''}`}
                  >
                    {globalShow ? (
                      <> <ToggleRight size={20} /> <span className="hidden xs:inline">Hide</span> </>
                    ) : (
                      <> <ToggleLeft size={20} /> <span className="hidden xs:inline">Show All</span> <span className="xs:hidden">Show</span> </>
                    )}
                  </button>
                </div>
              </div>

              {/* Main Content */}
              <div className="max-w-6xl mx-auto p-4 pt-6 pb-24">
                <div className={`mb-6 p-4 rounded-xl border text-center shadow-sm transition-colors ${selectionMode ? 'bg-indigo-50 border-indigo-200' : 'bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-100'}`}>
                  {selectionMode ? (
                      <div>
                          <p className="text-indigo-800 font-bold mb-1">โหมดเลือกข้อสอบ Quiz</p>
                          <p className="text-indigo-600 text-sm">ติ๊กเลือกประโยคที่ต้องการ แล้วกดปุ่ม Start ด้านล่าง</p>
                      </div>
                  ) : (
                      <p className="text-gray-600 text-sm md:text-base">
                        <span className="font-semibold text-blue-700">โหมดฝึกฝน:</span> {primaryLang === 'en' ? 'อ่านอังกฤษ -> แปลไทย' : 'อ่านไทย -> แปลอังกฤษ'}
                      </p>
                  )}
                </div>

                {SentenceData.map((category) => {
                  const currentStart = sentenceCounter;
                  sentenceCounter += category.sentences.length;
                  return (
                    <CategorySection 
                      key={category.id} 
                      category={category} 
                      globalShow={globalShow} 
                      primaryLang={primaryLang}
                      resetCount={resetCount}
                      startOffset={currentStart}
                      selectionMode={selectionMode}
                      selectedIds={selectedIds}
                      onToggleItem={toggleItemSelection}
                      onSelectAll={handleSelectAllCategory}
                    />
                  );
                })}
              </div>
              
              {/* Start Quiz FAB Area with Language Selection */}
              {selectionMode && selectedIds.size > 0 && (
                  <div className="fixed bottom-6 left-1/2 -translate-x-1/2 z-30 flex items-center gap-2 bg-white p-1.5 rounded-full shadow-2xl border border-gray-200 animate-bounce-in w-max max-w-[90vw] overflow-x-auto">
                    
                    {/* Language Toggle for Quiz */}
                    <div className="flex bg-gray-100 rounded-full p-1 shrink-0">
                        <button 
                            onClick={() => setQuizLang('en')}
                            className={`px-3 py-1.5 rounded-full text-xs font-bold transition-all ${quizLang === 'en' ? 'bg-white shadow text-blue-600' : 'text-gray-500 hover:text-gray-700'}`}
                        >
                            EN
                        </button>
                        <button 
                            onClick={() => setQuizLang('th')}
                            className={`px-3 py-1.5 rounded-full text-xs font-bold transition-all ${quizLang === 'th' ? 'bg-white shadow text-blue-600' : 'text-gray-500 hover:text-gray-700'}`}
                        >
                            TH
                        </button>
                    </div>

                    <button 
                        onClick={startQuiz}
                        className="bg-indigo-600 text-white px-5 py-2 rounded-full font-bold flex items-center gap-2 hover:bg-indigo-700 active:scale-95 transition-all shrink-0 text-sm whitespace-nowrap"
                    >
                        <Brain size={18} />
                        <span>Start ({selectedIds.size})</span>
                    </button>
                  </div>
              )}

              {/* Footer */}
              {!selectionMode && (
                <div className="text-center text-gray-400 text-xs py-6 border-t mt-8 bg-gray-50 fixed bottom-0 w-full z-10 hidden md:block">
                    English Sentence Bank • 300+ Sentences (A-M) • PWA Ready
                </div>
              )}
            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
    
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('Service Worker Registered'))
                    .catch(err => console.log('Service Worker Failed', err));
            });
        }
    </script>
</body>
</html>
